<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Qu√† Sinh Nh·∫≠t Anh Th∆∞</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
        background: radial-gradient(
          ellipse at center,
          #000011 0%,
          #000000 100%
        );
        font-family: "Segoe UI", sans-serif;
        user-select: none;
        cursor: pointer;
      }

      #galaxy,
      #rotatingContainer {
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        pointer-events: none;
        z-index: 1;
      }

      #rotatingContainer {
        z-index: 2;
        top: 50%;
        left: 50%;
        transform-style: preserve-3d;
        transform-origin: center center;
        transform: translate(-50%, -50%) rotateX(0deg) rotateY(0deg);
      }

      .text-particle,
      .image-particle {
        white-space: nowrap;
        position: absolute;
        will-change: transform, opacity;
        user-select: none;
        pointer-events: none;
        opacity: 0;
      }

      .text-particle {
        max-width: none;
        word-break: break-word;
        white-space: normal;
        color: #ff92b3;
        text-shadow: 0 0 6px #fff, 0 0 12px #ffb3c9;
        transition: transform 0.3s ease, font-size 0.3s ease;
      }

      .text-particle:hover {
        transform: scale(1.3);
      }

      .image-particle {
        max-width: 50px;
        max-height: 50px;
        border-radius: 5px;
        filter: drop-shadow(0 0 6px #fff);
      }
    </style>
  </head>
  <body>
    <div id="galaxy"></div>
    <div id="rotatingContainer"></div>

    <script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>
    <script>
      const rotatingContainer = document.getElementById("rotatingContainer");
      const galaxy = document.getElementById("galaxy");

      const messages = [
        "Ch√∫c Anh Th∆∞ sinh nh·∫≠t vui v·∫ªüíó",
        "22 - 09 - 2005üéÇ",
        "C√¥ b√© xinh x·∫Øn‚ù§Ô∏è",
        "C·∫£ th·∫ø gi·ªõi l√† c·ªßa Th∆∞üåπ",
        "Happy Birthday üéÇ",
      ];
      const imageURLs = ["thu1.jpg"];
      const icons = ["üíó", "üéÇ", "üåπ", "‚ú®"];
      const maxParticles = 60;
      const activeParticles = new Set();

      function createParticle(type = "text") {
        if (activeParticles.size >= maxParticles) return;

        const el =
          type === "text"
            ? document.createElement("div")
            : document.createElement("img");
        if (type === "text") {
          const isIcon = Math.random() < 0.3;
          el.className = "text-particle";
          el.textContent = isIcon
            ? icons[Math.floor(Math.random() * icons.length)]
            : messages[Math.floor(Math.random() * messages.length)];
          const fontMin = 24,
            fontMax = 36;
          const fs = fontMin + Math.random() * (fontMax - fontMin);
          el.style.fontSize = fs + "px";
        } else {
          el.className = "image-particle";
          el.src = imageURLs[Math.floor(Math.random() * imageURLs.length)];
        }

        rotatingContainer.appendChild(el);
        const w = el.offsetWidth || 40;
        el.style.left = Math.random() * (window.innerWidth - w) + "px";

        const startY = -50;
        const endY = window.innerHeight + 50;
        const driftX = (Math.random() - 0.5) * 100;
        const t0 = performance.now();
        const duration = 5000 + Math.random() * 3000;

        activeParticles.add(el);

        function animate(t) {
          const p = (t - t0) / duration;
          if (p >= 1) {
            el.remove();
            activeParticles.delete(el);
          } else {
            const y = startY + p * (endY - startY);
            const x = driftX * Math.sin(p * Math.PI * 2);
            const opacity = p < 0.1 ? p * 10 : p > 0.9 ? (1 - p) * 10 : 1;
            el.style.opacity = opacity;
            el.style.transform = `translate3d(${x}px, ${y}px, 0)`;
            requestAnimationFrame(animate);
          }
        }

        requestAnimationFrame(animate);
      }

      function loopParticles() {
        let last = 0;
        function tick(t) {
          if (t - last > 500) {
            createParticle("text");
            if (Math.random() < 0.4) createParticle("image");
            last = t;
          }
          requestAnimationFrame(tick);
        }
        requestAnimationFrame(tick);
      }

      function startStars() {
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(
          75,
          window.innerWidth / window.innerHeight,
          0.1,
          1000
        );
        camera.position.z = 150;

        const renderer = new THREE.WebGLRenderer({
          alpha: true,
          antialias: true,
        });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(
          window.devicePixelRatio ? Math.min(window.devicePixelRatio, 1.5) : 1
        );
        renderer.setClearColor(0x000000, 0);
        galaxy.appendChild(renderer.domElement);

        const starsCount = 500;
        const positions = new Float32Array(starsCount * 3);
        for (let i = 0; i < starsCount; i++) {
          positions[i * 3] = (Math.random() - 0.5) * 400;
          positions[i * 3 + 1] = (Math.random() - 0.5) * 400;
          positions[i * 3 + 2] = (Math.random() - 0.5) * 400;
        }

        const geometry = new THREE.BufferGeometry();
        geometry.setAttribute(
          "position",
          new THREE.BufferAttribute(positions, 3)
        );
        const material = new THREE.PointsMaterial({
          color: 0xffffff,
          size: 0.5,
          transparent: true,
          depthWrite: false,
        });
        const stars = new THREE.Points(geometry, material);
        scene.add(stars);

        let rotX = 0,
          rotY = 0,
          scale = 1;

        function animate() {
          stars.rotation.y += 0.0005;
          stars.rotation.x = rotX;
          stars.scale.set(scale, scale, scale);
          renderer.render(scene, camera);
          requestAnimationFrame(animate);
        }
        animate();

        window.addEventListener("wheel", (e) => {
          scale += e.deltaY > 0 ? -0.05 : 0.05;
          scale = Math.min(Math.max(scale, 0.7), 2);
        });

        document.addEventListener("mousemove", (e) => {
          const x = (e.clientX / window.innerWidth - 0.5) * 2;
          const y = (e.clientY / window.innerHeight - 0.5) * 2;
          rotY = x * 0.3;
          rotX = y * 0.3;
        });

        window.addEventListener("resize", () => {
          renderer.setSize(window.innerWidth, window.innerHeight);
          camera.aspect = window.innerWidth / window.innerHeight;
          camera.updateProjectionMatrix();
        });
      }

      function setupMusicAndFullscreen() {
        let started = false;
        document.body.addEventListener("click", () => {
          if (!started) {
            const audio = new Audio("./thu.mp3");
            audio.loop = true;
            audio
              .play()
              .catch(() => console.log("Kh√¥ng th·ªÉ ph√°t nh·∫°c t·ª± ƒë·ªông."));
            started = true;
          }

          if (!document.fullscreenElement) {
            const elem = document.documentElement;
            if (elem.requestFullscreen) {
              elem.requestFullscreen();
            } else if (elem.webkitRequestFullscreen) {
              elem.webkitRequestFullscreen();
            } else if (elem.msRequestFullscreen) {
              elem.msRequestFullscreen();
            }
          }
        });
      }

      window.addEventListener("DOMContentLoaded", () => {
        startStars();
        loopParticles();
        setupMusicAndFullscreen();
      });
    </script>
  </body>
</html>
